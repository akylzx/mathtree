'use client'

import { Navbar } from "@/components/navbar"
import { QuizComponent } from "@/components/quiz-component"
import { Button } from "@/components/ui/button"
import { ArrowLeft, ArrowRight } from "lucide-react"
import Link from "next/link"

interface Question {
  question: string;
  options: string[];
  correct: number;
}

interface LessonContentItem {
  title: string;
  content: string;
  questions: Question[];
}

const lessonContent: Record<string, LessonContentItem> = {
  // Place Value Lessons
  "place-value-1": {
    title: "Бірлік, Ондық, Жүздіктер",
    content:
      "Біздің сандар жүйесінде әр цифрдың өз орны бар. Оң жақтағы цифр - бірлік орнында, ортадағы цифр - ондық орнында, ал сол жақтағы цифр - жүздік орнында тұрады. Мысалы, 253 санында: 2 жүздік орнында (200), 5 ондық орнында (50), ал 3 бірлік орнында (3) тұр.",
    questions: [
      { question: "253 санындағы 5 цифрының мәні қандай?", options: ["5", "50", "500", "25"], correct: 1 },
      { question: "340 санында неше ондық бар?", options: ["3", "4", "0", "34"], correct: 1 },
      { question: "789 санындағы 7 цифрының мәні қандай?", options: ["7", "70", "700", "789"], correct: 2 },
      { question: "456 санында бірлік орнында қай цифр тұр?", options: ["4", "5", "6", "456"], correct: 2 },
    ],
  },
  "place-value-2": {
    title: "Оқу сандары",
    content:
      "3 таңбалы сандарды оқығанда, жүздіктен бастап, содан кейін ондықтарды, содан кейін бірліктерді оқыңыз. Мысалы, 347 'үш жүз қырық жеті' деп оқылады. Жүздік цифрынан кейін 'жүз' деп айтуды ұмытпаңыз.",
    questions: [
      {
        question: "582 санын қалай оқисыз?",
        options: ["Бес сегіз екі", "Бес жүз сексен екі", "Елу сегіз екі", "Бес жүз сегіз екі"],
        correct: 1,
      },
      {
        question: "309 санын қалай оқисыз?",
        options: ["Үш нөл тоғыз", "Үш жүз тоғыз", "Отыз тоғыз", "Үш нөл тоғыз"],
        correct: 1,
      },
      {
        question: "750 санын қалай оқисыз?",
        options: ["Жетпіс бес нөл", "Жеті жүз елу", "Жетпіс бес нөл", "Жеті бес нөл"],
        correct: 1,
      },
    ],
  },
  "place-value-3": {
    title: "Сандарды жазу",
    content:
      "Сандарды стандартты түрде жазу үшін, цифрларды дұрыс разрядтық мән позицияларына жазыңыз. Сөздерді мұқият тыңдаңыз: 'төрт жүз жиырма үш' 423 болады.",
    questions: [
      {
        question: "'Алты жүз қырық бір' санын стандартты түрде жазыңыз:",
        options: ["641", "604", "614", "461"],
        correct: 0,
      },
      { question: "'Екі жүз бес' санын стандартты түрде жазыңыз:", options: ["25", "250", "205", "2005"], correct: 2 },
      { question: "'Тоғыз жүз тоқсан' санын стандартты түрде жазыңыз:", options: ["99", "909", "990", "9090"], correct: 2 },
    ],
  },
  "place-value-4": {
    title: "Сандарды салыстыру",
    content:
      "Үш таңбалы сандарды салыстырғанда, ең үлкен разрядтан, яғни жүздіктер орнынан баста. Егер жүздіктер бірдей болса, ондықтарды, содан кейін бірліктерді салыстыр. > (үлкен), < (кіші), немесе = (тең) белгілерін қолдан.",
    questions: [
      { question: "245 және 254 сандарын салыстырғанда, қайсысы үлкен?", options: ["245", "254", "Тең", "Ешқайсысы"], correct: 1 },
      { question: "401 және 399 сандарын салыстырғанда, қайсысы кіші?", options: ["401", "399", "Тең", "Ешқайсысы"], correct: 1 },
      { question: "678 < 687 белгісі дұрыс па?", options: ["Иә", "Жоқ", "Мүмкін емес", "Білмеймін"], correct: 0 },
    ],
  },
  "place-value-5": {
    title: "Сандарды дөңгелектеу",
    content:
      "Сандарды жуықтап дөңгелектегенде, ең жақын ондыққа немесе жүздікке дейін дөңгелектейміз. Егер соңғы цифр 5 немесе одан үлкен болса, жоғары қарай дөңгелекте. Егер 5-тен кіші болса, төмен қарай дөңгелекте.",
    questions: [
      { question: "47-ні ең жақын ондыққа дейін дөңгелекте:", options: ["40", "50", "45", "48"], correct: 1 },
      { question: "123-ті ең жақын жүздікке дейін дөңгелекте:", options: ["100", "120", "200", "130"], correct: 0 },
      { question: "789-ды ең жақын ондыққа дейін дөңгелекте:", options: ["780", "790", "700", "800"], correct: 1 },
    ],
  },
  "place-value-6": {
    title: "Сандарды реттеу",
    content:
      "Сандарды реттеу дегеніміз - оларды өсу немесе кему ретімен орналастыру. Ең кіші немесе ең үлкен саннан бастап тізбекті құрастыр.",
    questions: [
      { question: "Мына сандарды өсу ретімен орналастыр: 54, 32, 87, 19", options: ["19, 32, 54, 87", "87, 54, 32, 19", "32, 19, 54, 87", "19, 54, 32, 87"], correct: 0 },
      { question: "Мына сандарды кему ретімен орналастыр: 105, 98, 112, 89", options: ["89, 98, 105, 112", "112, 105, 98, 89", "105, 112, 98, 89", "98, 89, 112, 105"], correct: 1 },
    ],
  },

  // Addition & Subtraction Lessons
  "addition-subtraction-1": {
    title: "2 таңбалы сандарды қосу",
    content:
      "2 таңбалы сандарды қосқанда, бірліктер орнынан бастап, содан кейін ондықтар орнын қосыңыз. Сандарды разрядтық мәні бойынша туралаңыз. Мысалы: 23 + 45 = 68 (3+5=8 бірлік, 2+4=6 ондық).",
    questions: [
      { question: "23 + 45 қанша болады?", options: ["68", "78", "58", "67"], correct: 0 },
      { question: "34 + 52 қанша болады?", options: ["86", "76", "96", "84"], correct: 0 },
      { question: "41 + 26 қанша болады?", options: ["67", "77", "57", "65"], correct: 0 },
    ],
  },
  "addition-subtraction-2": {
    title: "Топтастырумен қосу",
    content:
      "Бірліктер орнының қосындысы 10 немесе одан көп болғанда, біз топтастырамыз (бірді ауыстырамыз). Мысалы: 28 + 47. Алдымен, 8+7=15. Бірліктер орнына 5 жазып, 1-ді ондықтарға ауыстырамыз. Содан кейін 2+4+1=7 ондық. Жауабы: 75.",
    questions: [
      { question: "28 + 47 қанша болады?", options: ["65", "75", "85", "615"], correct: 1 },
      { question: "39 + 26 қанша болады?", options: ["55", "65", "515", "56"], correct: 1 },
      { question: "48 + 35 қанша болады?", options: ["73", "83", "713", "78"], correct: 1 },
    ],
  },
  "addition-subtraction-3": {
    title: "3 таңбалы сандарды қосу",
    content:
      "3 таңбалы сандарды қосқанда, бірліктерден бастап, содан кейін ондықтарды, содан кейін жүздіктерді қосыңыз. Қажет болса, топтастырыңыз (бірді ауыстырыңыз).",
    questions: [
      { question: "123 + 456 қанша болады?", options: ["579", "589", "679", "689"], correct: 0 },
      { question: "345 + 278 қанша болады?", options: ["613", "623", "523", "513"], correct: 1 },
      { question: "507 + 193 қанша болады?", options: ["600", "700", "701", "690"], correct: 1 },
    ],
  },
  "addition-subtraction-4": {
    title: "2 таңбалы сандарды азайту",
    content:
      "2 таңбалы сандарды азайтқанда, бірліктер орнынан бастап, содан кейін ондықтар орнын азайтыңыз. Қажет болса, қарыз алыңыз (ондықты алдыңғы разрядтан алыңыз).",
    questions: [
      { question: "45 - 23 қанша болады?", options: ["22", "12", "32", "23"], correct: 0 },
      { question: "63 - 17 қанша болады?", options: ["46", "56", "36", "45"], correct: 0 },
      { question: "80 - 35 қанша болады?", options: ["45", "55", "35", "40"], correct: 0 },
    ],
  },
  "addition-subtraction-5": {
    title: "3 таңбалы сандарды азайту",
    content:
      "3 таңбалы сандарды азайтқанда, бірліктерден бастап, содан кейін ондықтарды, содан кейін жүздіктерді азайтыңыз. Қажет болса, қарыз алыңыз.",
    questions: [
      { question: "567 - 123 қанша болады?", options: ["444", "434", "454", "344"], correct: 0 },
      { question: "700 - 250 қанша болады?", options: ["450", "550", "350", "400"], correct: 0 },
      { question: "915 - 380 қанша болады?", options: ["535", "525", "635", "625"], correct: 0 },
    ],
  },

  // Multiplication Facts Lessons
  "multiplication-facts-1": {
    title: "Көбейтуді түсіну",
    content:
      "Көбейту - қайталанатын қосу. 3 × 4 дегеніміз 3 топ 4-тен, немесе 4 + 4 + 4 = 12. Біз оны 4 топ 3-тен, немесе 3 + 3 + 3 + 3 = 12 деп те ойлауымызға болады.",
    questions: [
      {
        question: "2 × 5 нені білдіреді?",
        options: ["2 + 5", "5 + 5", "2 + 2 + 2 + 2 + 2", "5 топ 2-ден"],
        correct: 3,
      },
      { question: "3 × 4 қанша болады?", options: ["7", "12", "34", "43"], correct: 1 },
      { question: "4 × 3 нені көрсетеді?", options: ["4 + 3", "3 + 3 + 3 + 3", "4 + 4 + 4", "B және C екеуі де"], correct: 3 },
    ],
  },
  "multiplication-facts-2": {
    title: "Көбейту кестесі 0, 1, 2",
    content:
      "Бұл ең оңай көбейту фактілері! Кез келген сан × 0 = 0. Кез келген сан × 1 = сол сан. × 2 үшін, санды екі есе көбейтіңіз (өзіне қосыңыз).",
    questions: [
      { question: "7 × 0 қанша болады?", options: ["7", "0", "70", "1"], correct: 1 },
      { question: "9 × 1 қанша болады?", options: ["1", "9", "10", "0"], correct: 1 },
      { question: "6 × 2 қанша болады?", options: ["8", "12", "62", "26"], correct: 1 },
    ],
  },
  "multiplication-facts-3": {
    title: "Көбейту кестесі 3, 4, 5",
    content:
      "Енді 3, 4 және 5 көбейту кестесін үйренейік! 3-ке көбейту үшін санды 3 рет қосуға болады. 4-ке көбейту үшін 4 рет қосуға болады немесе екі рет екі еселеуге болады. 5-ке көбейту үшін санды 5 рет қосуға болады немесе 0 немесе 5-пен аяқталатын үлгіні есте сақтауға болады.",
    questions: [
      { question: "3 × 7 қанша болады?", options: ["18", "21", "24", "27"], correct: 1 },
      { question: "4 × 6 қанша болады?", options: ["20", "22", "24", "28"], correct: 2 },
      { question: "5 × 9 қанша болады?", options: ["40", "45", "50", "55"], correct: 1 },
    ],
  },
  "multiplication-facts-4": {
    title: "Көбейту кестесі 6, 7, 8",
    content:
      "Алтын, жетілік және сегіздік көбейту кестесін үйренуге дайынсың ба? Бұл кестелерді жаттау үшін жаттығу өте маңызды!",
    questions: [
      { question: "6 × 8 қанша болады?", options: ["42", "48", "54", "60"], correct: 1 },
      { question: "7 × 7 қанша болады?", options: ["42", "49", "56", "63"], correct: 1 },
      { question: "8 × 4 қанша болады?", options: ["28", "32", "36", "40"], correct: 1 },
    ],
  },
  "multiplication-facts-5": {
    title: "Көбейту кестесі 9, 10",
    content:
      "Ең үлкен көбейту кестелеріне жеттік! 9-ға көбейту кестесінде қызықты үлгілер бар. 10-ға көбейту өте оңай, жай ғана санның соңына нөл қоссаң болды!",
    questions: [
      { question: "9 × 5 қанша болады?", options: ["40", "45", "50", "55"], correct: 1 },
      { question: "10 × 8 қанша болады?", options: ["18", "80", "810", "108"], correct: 1 },
      { question: "9 × 9 қанша болады?", options: ["72", "81", "90", "99"], correct: 1 },
    ],
  },

  // Fractions Lessons
  "fractions-1": {
    title: "Бөлшектер деген не?",
    content:
      "Бөлшек бүтіннің бөліктерін көрсетеді. Төменгі сан (бөлім) бүтіннің неше тең бөлікке бөлінгенін көрсетеді. Жоғарғы сан (алым) біз қанша бөлік туралы айтып отырғанымызды көрсетеді.",
    questions: [
      {
        question: "1/4 бөлшегінде 4 нені білдіреді?",
        options: ["1 бөлік", "Барлығы 4 бөлік", "4 бүтін", "1 бүтін"],
        correct: 1,
      },
      {
        question: "Егер пицца 8 тең тілімге бөлініп, сіз 3 тілім жесеңіз, сіз қандай бөлшекті жедіңіз?",
        options: ["8/3", "3/8", "3/5", "5/8"],
        correct: 1,
      },
      {
        question: "Егер 6 тең бөліктің 2-уі боялған болса, бұл шеңбердің қандай бөлшегі боялған?",
        options: ["2/6", "6/2", "2/4", "4/6"],
        correct: 0,
      },
    ],
  },
  "fractions-2": {
    title: "Бөлшектерді салыстыру",
    content:
      "Бірдей бөлімдері бар бөлшектерді салыстыру оңай. Алымы үлкен бөлшек үлкенірек болады. Мысалы, 3/5 > 2/5.",
    questions: [
      { question: "1/2 және 1/3-ті салыстырғанда, қайсысы үлкен?", options: ["1/2", "1/3", "Тең", "Ешқайсысы"], correct: 0 },
      { question: "3/4 және 2/4-ті салыстырғанда, қайсысы кіші?", options: ["3/4", "2/4", "Тең", "Ешқайсысы"], correct: 1 },
      { question: "5/6 > 4/6 дұрыс па?", options: ["Иә", "Жоқ", "Мүмкін емес", "Білмеймін"], correct: 0 },
    ],
  },
  "fractions-3": {
    title: "Эквивалентті бөлшектер",
    content:
      "Эквивалентті бөлшектер әртүрлі болып көрінуі мүмкін, бірақ олар бірдей мөлшерді білдіреді. Мысалы, 1/2 және 2/4 эквивалентті бөлшектер. Оларды көбейту немесе бөлу арқылы табуға болады.",
    questions: [
      { question: "1/2-ге эквивалентті бөлшек қайсысы?", options: ["2/3", "2/4", "3/5", "1/4"], correct: 1 },
      { question: "4/8-ге эквивалентті бөлшек қайсысы?", options: ["1/2", "2/4", "3/6", "Барлығы"], correct: 3 },
      { question: "6/10 бөлшегінің ең қарапайым түрі қайсысы?", options: ["3/5", "2/5", "6/10", "1/10"], correct: 0 },
    ],
  },
  "fractions-4": {
    title: "Бөлшектерді қосу және азайту",
    content:
      "Бірдей бөлімдері бар бөлшектерді қосқанда немесе азайтқанда, тек алымдарын қосыңыз немесе азайтыңыз, ал бөлімін сол күйінде қалдырыңыз. Мысалы, 1/4 + 2/4 = 3/4.",
    questions: [
      { question: "1/5 + 2/5 қанша болады?", options: ["3/5", "3/10", "1/5", "2/25"], correct: 0 },
      { question: "4/7 - 1/7 қанша болады?", options: ["3/7", "3/0", "5/7", "4/7"], correct: 0 },
      { question: "2/8 + 3/8 қанша болады?", options: ["5/8", "5/16", "6/8", "1/8"], correct: 0 },
    ],
  },

  // Word Problems Lessons
  "word-problems-1": {
    title: "Есептерді түсіну",
    content:
      "Есептерді шығару үшін: 1) Мұқият оқыңыз, 2) Маңызды сандарды табыңыз, 3) Қандай амал қолдану керектігін шешіңіз (+, -, ×, ÷), 4) Шығарыңыз, 5) Жауабыңыздың дұрыстығын тексеріңіз.",
    questions: [
      {
        question: "Сарада 15 жапсырма бар. Ол досына 6-уын береді. Оның қанша жапсырмасы қалды?",
        options: ["21", "9", "15", "6"],
        correct: 1,
      },
      {
        question: "Әр қорапта 7 қарындаштан 4 қорап бар. Барлығы неше қарындаш бар?",
        options: ["11", "28", "47", "3"],
        correct: 1,
      },
      {
        question:
          "Том 24 қабыршақ жинап, оларды 3 досымен теңдей бөліскісі келеді. Әр досы қанша қабыршақ алады?",
        options: ["8", "21", "27", "72"],
        correct: 0,
      },
    ],
  },
  "word-problems-2": {
    title: "Қосу және азайту есептері",
    content:
      "Қосу және азайтуды қажет ететін есептерді шешу үшін, есепті мұқият оқып, қандай амал қолдану керектігін анықта.",
    questions: [
      { question: "Айжанның 12 қарындашы бар, ол тағы 8 қарындаш сатып алды. Оның барлығы қанша қарындашы бар?", options: ["4", "20", "12", "8"], correct: 1 },
      { question: "Дүкенде 25 алма бар еді. Оның 10-ын сатып алды. Қанша алма қалды?", options: ["15", "35", "10", "25"], correct: 0 },
      { question: "Ерланның 18 ойыншық машинасы бар. Оған інісі 5 машина берді. Оның неше машинасы болды?", options: ["13", "23", "18", "5"], correct: 1 },
    ],
  },
  "word-problems-3": {
    title: "Көбейту және бөлу есептері",
    content:
      "Көбейту және бөлуді қажет ететін есептерді шешу үшін, есепті мұқият оқып, қай амалдың қолайлы екенін анықта.",
    questions: [
      { question: "Әр қатарда 6 орындықтан 3 қатар бар. Барлығы неше орындық бар?", options: ["9", "18", "3", "6"], correct: 1 },
      { question: "20 кәмпитті 4 балаға теңдей бөліп берсе, әр балаға қанша кәмпиттен тиеді?", options: ["4", "5", "16", "24"], correct: 1 },
      { question: "Бір қорапта 8 қалам бар. 5 қорапта қанша қалам бар?", options: ["13", "3", "40", "85"], correct: 2 },
    ],
  },
  "word-problems-4": {
    title: "Аралас амалдар есептері",
    content:
      "Кейбір есептер бірнеше амалды қажет етеді. Есепті мұқият оқып, қадамдарды ретімен орында.",
    questions: [
      { question: "Маратта 10 алма бар еді. Ол тағы 5 алма сатып алды, содан кейін 3 алма жеді. Оның қанша алмасы қалды?", options: ["12", "18", "15", "7"], correct: 0 },
      { question: "Бір қорапта 6 қарындаштан 2 қорап бар. Егер 4 қарындашты досына берсе, қанша қарындаш қалды?", options: ["12", "8", "10", "2"], correct: 1 },
      { question: "Мұғалімде 24 қалам бар. Ол оларды 3 оқушыға теңдей бөліп берді. Содан кейін әр оқушы тағы 2 қалам сатып алды. Әр оқушыда қанша қалам бар?", options: ["8", "10", "6", "4"], correct: 1 },
    ],
  },
  // Geometry Lessons
  "geometry-1": {
    title: "Пішіндер әлемі",
    content:
      "Бізді қоршаған әлем пішіндерге толы! Дөңгелек, шаршы, үшбұрыш және тіктөртбұрыш сияқты негізгі пішіндерді ажыратуды үйренейік.",
    questions: [
      { question: "Қай пішіннің төрт тең қабырғасы бар?", options: ["Үшбұрыш", "Шаршы", "Дөңгелек", "Тіктөртбұрыш"], correct: 1 },
      { question: "Дөңгелекке ұқсайтын затқа мысал келтір:", options: ["Кітап", "Доп", "Есік", "Терезе"], correct: 1 },
      { question: "Үшбұрыштың неше қабырғасы бар?", options: ["Екі", "Үш", "Төрт", "Бес"], correct: 1 },
    ],
  },
  "geometry-2": {
    title: "Қабырғалар мен төбелер",
    content:
      "Пішіндердің қабырғалары мен төбелері бар. Қабырға - пішіннің түзу сызықты бөлігі, ал төбе - екі немесе одан да көп қабырғалар қосылатын нүкте. Мысалы, шаршының 4 қабырғасы және 4 төбесі бар.",
    questions: [
      { question: "Тіктөртбұрыштың неше төбесі бар?", options: ["Екі", "Үш", "Төрт", "Бес"], correct: 2 },
      { question: "Үшбұрыштың неше қабырғасы бар?", options: ["Екі", "Үш", "Төрт", "Бес"], correct: 1 },
      { question: "Дөңгелектің қабырғасы бар ма?", options: ["Иә", "Жоқ", "Бір", "Екі"], correct: 1 },
    ],
  },
  "geometry-3": {
    title: "Көлемді пішіндер (3D)",
    content:
      "Көлемді пішіндер - бұл біз ұстап көре алатын пішіндер! Куб, шар, цилиндр және конус сияқты пішіндерді зерттейік.",
    questions: [
      { question: "Қай пішіннің барлық жақтары шаршы тәрізді?", options: ["Шар", "Цилиндр", "Куб", "Конус"], correct: 2 },
      { question: "Футбол добы қай пішінге ұқсайды?", options: ["Куб", "Цилиндр", "Шар", "Конус"], correct: 2 },
      { question: "Қай пішіннің екі дөңгелек табаны бар?", options: ["Куб", "Шар", "Цилиндр", "Конус"], correct: 2 },
    ],
  },
}

export default function LessonPage({ params }: { params: { topicId: string; lessonId: string } }) {
  const lessonKey = `${params.topicId}-${params.lessonId}`
  const lesson = lessonContent[lessonKey]

  if (!lesson) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center">
        <div className="text-center">
          <h1 className="text-2xl font-bold text-primary mb-4">Сабақ жақында шығады! 🚧</h1>
          <p className="text-muted-foreground mb-4">Бұл сабақ сен үшін дайындалуда.</p>
          <Link href={`/topic/${params.topicId}`}>
            <Button>Тақырыпқа оралу</Button>
          </Link>
        </div>
      </div>
    )
  }

  const handleLessonComplete = () => {
    console.log("[v0] Lesson completed, unlocking next lesson")
    // In a real app, this would update the database/local storage
    alert("Тамаша! Сен бұл сабақты аяқтадың. Келесі сабақ ашылды!")
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-50">
      <Navbar />
      <main className="container mx-auto px-4 py-8 max-w-4xl">
        <div className="mb-6">
          <Link href={`/topic/${params.topicId}`}>
            <Button variant="ghost" size="sm" className="mb-4">
              <ArrowLeft className="w-4 h-4 mr-2" />
              Тақырыпқа оралу
            </Button>
          </Link>

          <div className="bg-white rounded-lg p-8 shadow-lg">
            <h1 className="text-3xl font-bold text-primary mb-6 text-center">{lesson.title}</h1>

            <div className="mb-8">
              <h2 className="text-xl font-semibold mb-4">📚 Үйрен</h2>
              <p className="text-lg leading-relaxed bg-blue-50 p-4 rounded-lg">{lesson.content}</p>
            </div>

            <QuizComponent questions={lesson.questions} onComplete={handleLessonComplete} />

            <div className="mt-8 flex justify-between">
              <Link href={`/topic/${params.topicId}`}>
                <Button variant="outline">
                  <ArrowLeft className="w-4 h-4 mr-2" />
                  Сабақтарға оралу
                </Button>
              </Link>

              <Link href={`/lesson/${params.topicId}/${Number.parseInt(params.lessonId) + 1}`}>
                <Button>
                  Келесі сабақ
                  <ArrowRight className="w-4 h-4 ml-2" />
                </Button>
              </Link>
            </div>
          </div>
        </div>
      </main>
    </div>
  )
}
